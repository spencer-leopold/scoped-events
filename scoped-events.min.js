"use strict";function ScopedEvents(){}ScopedEvents.prototype.on=function(t,e,s){if(!e)throw new Error("A callback function is required when adding an event listener");if(this._listeners=this._listeners||{},this._listeners[t]=this._listeners[t]||[],this._listeners[t].length){var i=this.getExistingMatch(this._listeners[t],e,s);i.length||this._listeners[t].push({fn:e,ctx:s||this})}else this._listeners[t].push({fn:e,ctx:s||this})},ScopedEvents.prototype.remove=function(t,e,s){this._listeners=this._listeners||{};var i;if(!t&&!e&&!s)return this._listeners=[],this._listeners;if(!t){for(var n in this._listeners)if(this._listeners.hasOwnProperty(n)){var r=this._listeners[n];i=this.getExistingMatch(r,e,s);for(var l=0;l<i.length;l++)r.splice(i[l],1);r.length||delete this._listeners[n]}return this._listeners}if(this._listeners[t])if(e||s){i=this.getExistingMatch(this._listeners[t],e,s);for(var h=0;h<i.length;h++)this._listeners[t].splice(i[h],1)}else delete this._listeners[t]},ScopedEvents.prototype.trigger=function(t){this._listeners=this._listeners||{};for(var e="",s=t.split(":"),i=s.length,n=Array.prototype.slice.call(arguments,1),r=0;i>r;r++){var l=s[r];""===e?e=l:e+=":"+l;var h=s.slice(r+1,i).join(":");if(""===h&&(h=null),this._listeners[e])for(var o=this._listeners[e],c=o.length,p=0;c>p;p++){var a=o[p];a.fn.apply(a.ctx||this,[h].concat(n))}this.triggerEventAll.apply(this,[e].concat(n))}},ScopedEvents.prototype.triggerEventAll=function(){if(this._listeners=this._listeners||{},this._listeners.all)for(var t=this._listeners.all,e=t.length,s=0;e>s;s++){var i=t[s];i.fn.apply(i.ctx||this,arguments)}},ScopedEvents.prototype.getExistingMatch=function(t,e,s){var i=t.map(function(t,i){if(s){if(e){if(t.fn===e&&t.ctx===s)return i}else if(t.ctx===s)return i}else if(t.fn===e)return i}).filter(isFinite);return i},ScopedEvents.mixin=function(t){for(var e=["on","remove","trigger","triggerEventAll","getExistingMatch"],s="function"==typeof t?t.prototype:t,i=0;i<e.length;i++){var n=e[i];s[n]=ScopedEvents.prototype[n]}return s},ScopedEvents.Dispatcher=new ScopedEvents,module.exports=ScopedEvents;